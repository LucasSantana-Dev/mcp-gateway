# MCP Gateway â€“ copy to .env and set real values.
# Do not use these placeholder values in production; generate strong secrets.
# Values with # ! % $ or spaces: use single quotes (e.g. PLATFORM_ADMIN_PASSWORD='pass#word!')
# Prefer: make start, make register, make jwt, make list-prompts (see Makefile and scripts/README.md).
#
# ============================================================================
# MINIMAL .ENV CONFIGURATION PHILOSOPHY
# ============================================================================
# This .env file contains ONLY gateway infrastructure configuration.
# Stack-specific API keys (GitHub, Tavily, Snyk, databases, etc.) should be
# configured in your IDE's mcp.json file, NOT here.
#
# Benefits:
# - IDE-portable configurations (easy to share/version control)
# - No secrets in repository .env files
# - Per-user customization without affecting team setup
# - Clear separation: gateway infrastructure vs. stack-specific credentials
#
# For detailed setup instructions, see:
# - docs/ENVIRONMENT_CONFIGURATION.md - Minimal .env vs IDE configuration guide
# - docs/IDE_SETUP_GUIDE.md - IDE-specific configuration examples
# ============================================================================

# --- Required ---
HOST=0.0.0.0
PORT=4444
DATABASE_URL=sqlite:///./mcp.db

# At least 32 characters each. Weak values cause gateway warnings and context-forge "Server disconnected" / "Needs authentication". Run: make generate-secrets
JWT_SECRET_KEY=REPLACE_WITH_STRONG_SECRET
AUTH_ENCRYPTION_SECRET=REPLACE_WITH_STRONG_SALT
PLATFORM_ADMIN_EMAIL=admin@example.com
PLATFORM_ADMIN_PASSWORD=REPLACE_ME
PLATFORM_ADMIN_FULL_NAME="Platform Administrator"

MCPGATEWAY_UI_ENABLED=true
MCPGATEWAY_ADMIN_API_ENABLED=true
SECURE_COOKIES=false
# Set to false for local development to skip JWT authentication (simplifies NPX client usage)
# Set to true for production/remote access (requires JWT token in NPX client)
AUTH_REQUIRED=true

# --- Register script (used by make register) ---
# URL for health check (default http://localhost:PORT). If health fails, script retries localhost/127.0.0.1. On Docker Desktop for Mac, prefer http://localhost:PORT.
# GATEWAY_URL=http://localhost:4444

# Wait up to N seconds for gateway /health (default 90)
# REGISTER_GATEWAY_MAX_WAIT=90

# Wait N seconds after gateway is up before registering (avoids "Unable to connect" for local translate services like sqlite)
REGISTER_WAIT_SECONDS=30

# Extra gateways: comma-separated Name|URL or Name|URL|Transport. Context7/Prisma may need API keys in Admin UI (Passthrough Headers), not here.
# EXTRA_GATEWAYS=Context7|https://mcp.context7.com/mcp|STREAMABLEHTTP,prisma-remote|https://mcp.prisma.io/mcp|STREAMABLEHTTP

# Create/update virtual server and print Cursor URL (requires jq). Set false to skip.
# REGISTER_VIRTUAL_SERVER=true
# REGISTER_VIRTUAL_SERVER_NAME=default
# Which virtual server URL to write to data/.cursor-mcp-url (wrapper uses it). If unset, default is cursor-router (tool-router). To use the full tool set, set cursor-default.
# REGISTER_CURSOR_MCP_SERVER_NAME=cursor-default
# Seconds to wait before syncing tools/virtual servers (default 3). If GET /servers returns non-200, script skips virtual server create/update and suggests Admin UI or retry.
# REGISTER_VIRTUAL_SERVER_DELAY=3
# When GET /servers returns 5xx or 408, delay in seconds before extra retries (default 5). Set to 0 to disable delayed retries.
# REGISTER_GET_SERVERS_RETRY_DELAY=5
# When set to true/1/yes and GET /servers still fails after retries, attempt create-only (POST) for virtual servers; no update, possible duplicates if run again. See docs/ADMIN_UI_MANUAL_REGISTRATION.md.
# REGISTER_VIRTUAL_SERVER_CREATE_WHEN_GET_FAILS=

# Register prompts from scripts/prompts.txt; set true then run make register
# REGISTER_PROMPTS=false

# Register resources from scripts/resources.txt; set true then run make register
# REGISTER_RESOURCES=false

# --- Optional: translate services (ports and API keys) ---
# SEQUENTIAL_THINKING_PORT=8013
# CHROME_DEVTOOLS_PORT=8014
# PLAYWRIGHT_PORT=8015
# MAGICUIDESIGN_PORT=8016
# DESKTOP_COMMANDER_PORT=8017
# PUPPETEER_PORT=8018
# BROWSER_TOOLS_PORT=8019
# TAVILY_PORT=8020
# FILESYSTEM_PORT=8021
# REACTBITS_PORT=8022
# SNYK_PORT=8023
# SQLITE_PORT=8024
# GITHUB_PORT=8025
# UIFORGE_PORT=8026
# MEMORY_PORT=8027
# GIT_MCP_PORT=8028
# FETCH_PORT=8029
# TOOL_ROUTER_PORT=8030
# POSTGRES_PORT=8031
# MONGODB_PORT=8032

# ============================================================================
# STACK-SPECIFIC API KEYS - CONFIGURE IN YOUR IDE'S mcp.json, NOT HERE
# ============================================================================
# The following API keys should be configured in your IDE's MCP configuration
# file (e.g., ~/.cursor/mcp.json, .vscode/settings.json, .windsurf/mcp.json)
# as environment variables in the "env" object.
#
# See docs/IDE_SETUP_GUIDE.md for detailed examples for each IDE.
# See docs/ENVIRONMENT_CONFIGURATION.md for migration guide.
# ============================================================================

# TAVILY_API_KEY - Configure in IDE's mcp.json env object
# SNYK_TOKEN - Configure in IDE's mcp.json env object
# GITHUB_PERSONAL_ACCESS_TOKEN - Configure in IDE's mcp.json env object
# POSTGRES_CONNECTION_STRING - Configure in IDE's mcp.json env object
# MONGODB_CONNECTION_STRING - Configure in IDE's mcp.json env object
# FIGMA_ACCESS_TOKEN - Configure in IDE's mcp.json env object (for uiforge)

# Docker volume configurations (these can stay in .env)
# FILESYSTEM_PATH=/workspace
# FILESYSTEM_VOLUME=./workspace
# MEMORY_VOLUME=./data/memory
# GIT_REPO_VOLUME=./workspace
# SQLITE_DB_PATH=/data/sqlite.db
# SQLITE_VOLUME=./data

# Tool router (cursor-router virtual server): JWT for gateway API. Run make jwt and paste the token; refresh periodically (e.g. weekly).
# GATEWAY_JWT=

# --- Feature Toggles (17 fine-grained controls) ---
# Naming Convention: FEATURE_<CATEGORY>_<NAME>
# All features default to true for backward compatibility

# Core Features
FEATURE_CORE_AI_ROUTER=true
FEATURE_CORE_HYBRID_SCORING=true
FEATURE_CORE_TOOL_SEARCH=true
FEATURE_CORE_EXECUTE_TASK=true

# API Features
FEATURE_API_HEALTH=true
FEATURE_API_METRICS=true
FEATURE_API_LIFECYCLE=true
FEATURE_API_IDE_CONFIG=true
FEATURE_API_FEATURES=true

# Tool Features (MCP Tools)
FEATURE_TOOL_LIST_SERVERS=true
FEATURE_TOOL_GET_SERVER_STATUS=true
FEATURE_TOOL_ENABLE_SERVER=true
FEATURE_TOOL_DISABLE_SERVER=true

# UI Features
FEATURE_UI_WEB_ADMIN=true
FEATURE_UI_FEATURE_TOGGLES=true
FEATURE_UI_SERVER_MANAGEMENT=true
FEATURE_UI_GATEWAY_MONITORING=true

# --- AI-powered tool routing (Ollama) ---
# Enable AI-powered tool selection using local LLM (default: true)
# Note: ROUTER_AI_ENABLED is backward compatible with FEATURE_CORE_AI_ROUTER
ROUTER_AI_ENABLED=true

# AI provider (currently only "ollama" supported)
ROUTER_AI_PROVIDER=ollama

# Ollama model to use for tool selection (default: llama3.2:3b, ~2GB)
# Alternatives: mistral:7b, llama3.2:1b (smaller/faster), llama3.1:8b (larger/better)
ROUTER_AI_MODEL=llama3.2:3b

# Ollama service endpoint (default: http://ollama:11434 for Docker)
# For local testing outside Docker, use: http://localhost:11434
ROUTER_AI_ENDPOINT=http://ollama:11434

# Ollama port (default: 11434)
OLLAMA_PORT=11434

# AI selection timeout in milliseconds (default: 5000ms = 5s)
# Increased for Ollama model cold starts; use OLLAMA_KEEP_ALIVE to prevent unloading
# Falls back to keyword matching on timeout
ROUTER_AI_TIMEOUT_MS=5000

# Weight for AI score in hybrid scoring (default: 0.7 = 70% AI, 30% keyword)
# Range: 0.0 (pure keyword) to 1.0 (pure AI)
ROUTER_AI_WEIGHT=0.7

# Minimum AI confidence threshold for using AI selection (default: 0.3)
# If AI confidence is below this threshold, falls back to keyword matching
# Range: 0.0 to 1.0
ROUTER_AI_MIN_CONFIDENCE=0.3

# --- Optional: debug / overrides ---
# Debug: REGISTER_VERBOSE=1 make register prints full API response on failure
# REGISTER_VERBOSE=

# Override gateway container name for make jwt and make list-prompts (default mcpgateway)
# MCPGATEWAY_CONTAINER=mcpgateway

# Cursor MCP wrapper: used if data/.cursor-mcp-url is missing (e.g. http://host.docker.internal:4444/servers/<UUID>/mcp)
# CURSOR_MCP_SERVER_URL=

# Cursor MCP server timeout in ms (make use-cursor-wrapper sets this in mcp.json; default 120000). Increase if you see -32001 Request timed out.
# CURSOR_MCP_TIMEOUT_MS=120000
