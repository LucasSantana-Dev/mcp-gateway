<?xml version="1.0" encoding="utf-8"?><testsuites><testsuite name="pytest" errors="0" failures="7" skipped="0" tests="22" time="6.590" timestamp="2026-02-17T23:31:12.038235" hostname="MacBook-Pro-de-Lucas-10.local"><testcase classname="tests.test_sleep_wake.TestServiceSleep" name="test_sleep_service_success" time="0.018" /><testcase classname="tests.test_sleep_wake.TestServiceSleep" name="test_sleep_service_disabled" time="0.002" /><testcase classname="tests.test_sleep_wake.TestServiceSleep" name="test_sleep_service_not_running" time="0.004" /><testcase classname="tests.test_sleep_wake.TestServiceSleep" name="test_sleep_service_resource_pressure" time="0.005" /><testcase classname="tests.test_sleep_wake.TestServiceSleep" name="test_sleep_service_min_sleep_time" time="1.016" /><testcase classname="tests.test_sleep_wake.TestServiceSleep" name="test_sleep_service_error" time="0.010"><failure message="AssertionError: assert 'Failed to sleep service' in ''&#10; +  where '' = str(HTTPException(status_code=500, detail='Failed to sleep service test-service: Docker error'))&#10; +    where HTTPException(status_code=500, detail='Failed to sleep service test-service: Docker error') = &lt;ExceptionInfo HTTPException(status_code=500, detail='Failed to sleep service test-service: Docker error') tblen=2&gt;.value">self = &lt;test_sleep_wake.TestServiceSleep object at 0x10b98eca0&gt;, service_manager = &lt;service_manager.ServiceManager object at 0x10bb74ee0&gt;
mock_container = &lt;Mock name='mock.containers.get()' id='4492502352'&gt;

    @pytest.mark.asyncio
    async def test_sleep_service_error(self, service_manager, mock_container):
        """Test sleep error handling."""
        # Setup - mock container error
        mock_container.pause.side_effect = Exception("Docker error")
        service_manager.docker_client.containers.get.return_value = mock_container
    
        # Mock system resources
        with patch.object(service_manager.resource_monitor, 'get_system_resources') as mock_resources:
            mock_resources.return_value = {
                "cpu_percent": 50.0,
                "memory_percent": 60.0,
                "memory_available_gb": 8.0,
                "memory_used_gb": 4.0,
                "memory_total_gb": 12.0
            }
    
            # Execute &amp; Verify
            with pytest.raises(Exception) as exc_info:
                await service_manager.sleep_service("test-service")
    
&gt;           assert "Failed to sleep service" in str(exc_info.value)
E           AssertionError: assert 'Failed to sleep service' in ''
E            +  where '' = str(HTTPException(status_code=500, detail='Failed to sleep service test-service: Docker error'))
E            +    where HTTPException(status_code=500, detail='Failed to sleep service test-service: Docker error') = &lt;ExceptionInfo HTTPException(status_code=500, detail='Failed to sleep service test-service: Docker error') tblen=2&gt;.value

tests/test_sleep_wake.py:239: AssertionError</failure></testcase><testcase classname="tests.test_sleep_wake.TestServiceWake" name="test_wake_service_success" time="0.004"><failure message="AttributeError: 'ServiceManager' object has no attribute 'wake_service'">self = &lt;test_sleep_wake.TestServiceWake object at 0x10b98ef40&gt;, service_manager = &lt;service_manager.ServiceManager object at 0x10bc6f310&gt;
mock_container = &lt;Mock name='mock.containers.get()' id='4492503216'&gt;

    @pytest.mark.asyncio
    async def test_wake_service_success(self, service_manager, mock_container):
        """Test successful service wake."""
        # Setup
        service_manager.service_status["test-service"].status = "sleeping"
        service_manager.service_status["test-service"].sleep_start_time = time.time() - 300  # 5 minutes ago
        service_manager.docker_client.containers.get.return_value = mock_container
    
        # Execute
&gt;       result = await service_manager.wake_service("test-service")
E       AttributeError: 'ServiceManager' object has no attribute 'wake_service'

tests/test_sleep_wake.py:255: AttributeError</failure></testcase><testcase classname="tests.test_sleep_wake.TestServiceWake" name="test_wake_service_not_sleeping" time="0.087"><failure message="AttributeError: 'ServiceManager' object has no attribute 'wake_service'">self = &lt;test_sleep_wake.TestServiceWake object at 0x10bb6d100&gt;, service_manager = &lt;service_manager.ServiceManager object at 0x10bc90070&gt;

    @pytest.mark.asyncio
    async def test_wake_service_not_sleeping(self, service_manager):
        """Test wake when service is not sleeping."""
        # Setup - service is already running
        service_manager.service_status["test-service"].status = "running"
    
        # Execute
&gt;       result = await service_manager.wake_service("test-service")
E       AttributeError: 'ServiceManager' object has no attribute 'wake_service'

tests/test_sleep_wake.py:274: AttributeError</failure></testcase><testcase classname="tests.test_sleep_wake.TestServiceWake" name="test_wake_service_error" time="0.002"><failure message="assert 'Failed to wake service' in &quot;'ServiceManager' object has no attribute 'wake_service'&quot;&#10; +  where &quot;'ServiceManager' object has no attribute 'wake_service'&quot; = str(AttributeError(&quot;'ServiceManager' object has no attribute 'wake_service'&quot;))&#10; +    where AttributeError(&quot;'ServiceManager' object has no attribute 'wake_service'&quot;) = &lt;ExceptionInfo AttributeError(&quot;'ServiceManager' object has no attribute 'wake_service'&quot;) tblen=1&gt;.value">self = &lt;test_sleep_wake.TestServiceWake object at 0x10bb6d280&gt;, service_manager = &lt;service_manager.ServiceManager object at 0x10bc62f70&gt;
mock_container = &lt;Mock name='mock.containers.get()' id='4492452720'&gt;

    @pytest.mark.asyncio
    async def test_wake_service_error(self, service_manager, mock_container):
        """Test wake error handling."""
        # Setup
        service_manager.service_status["test-service"].status = "sleeping"
        mock_container.unpause.side_effect = Exception("Docker error")
        service_manager.docker_client.containers.get.return_value = mock_container
    
        # Execute &amp; Verify
        with pytest.raises(Exception) as exc_info:
            await service_manager.wake_service("test-service")
    
&gt;       assert "Failed to wake service" in str(exc_info.value)
E       assert 'Failed to wake service' in "'ServiceManager' object has no attribute 'wake_service'"
E        +  where "'ServiceManager' object has no attribute 'wake_service'" = str(AttributeError("'ServiceManager' object has no attribute 'wake_service'"))
E        +    where AttributeError("'ServiceManager' object has no attribute 'wake_service'") = &lt;ExceptionInfo AttributeError("'ServiceManager' object has no attribute 'wake_service'") tblen=1&gt;.value

tests/test_sleep_wake.py:291: AssertionError</failure></testcase><testcase classname="tests.test_sleep_wake.TestResourceMonitoring" name="test_get_system_resources" time="0.003" /><testcase classname="tests.test_sleep_wake.TestResourceMonitoring" name="test_get_container_resources" time="0.003" /><testcase classname="tests.test_sleep_wake.TestWakePrediction" name="test_predict_service_wake_need" time="0.001"><failure message="assert 0.325 &gt; 0.5">self = &lt;test_sleep_wake.TestWakePrediction object at 0x10bb6d7f0&gt;, service_manager = &lt;service_manager.ServiceManager object at 0x10bcce280&gt;

    def test_predict_service_wake_need(self, service_manager):
        """Test wake need prediction."""
        # Setup - service with some usage
        metrics = service_manager.performance_metrics["test-service"]
        metrics.total_requests = 50
        metrics.wake_times.extend([100, 150, 200])  # Recent wake times
    
        result = service_manager.predict_service_wake_need("test-service")
    
        assert 0.0 &lt;= result &lt;= 1.0
&gt;       assert result &gt; 0.5  # Should be moderately likely due to usage
E       assert 0.325 &gt; 0.5

tests/test_sleep_wake.py:343: AssertionError</failure></testcase><testcase classname="tests.test_sleep_wake.TestWakePrediction" name="test_predict_service_wake_need_unknown_service" time="0.001" /><testcase classname="tests.test_sleep_wake.TestWakePrediction" name="test_get_pre_warm_candidates" time="0.002" /><testcase classname="tests.test_sleep_wake.TestWakePrediction" name="test_apply_wake_predictions_disabled" time="0.004" /><testcase classname="tests.test_sleep_wake.TestPriorityManagement" name="test_get_service_priority" time="0.001" /><testcase classname="tests.test_sleep_wake.TestPriorityManagement" name="test_should_skip_sleep_due_to_pressure" time="0.002" /><testcase classname="tests.test_sleep_wake.TestAPIEndpoints" name="test_request_wake_endpoint" time="0.163"><failure message="TypeError: __init__() got an unexpected keyword argument 'app'">self = &lt;test_sleep_wake.TestAPIEndpoints object at 0x10bb6d460&gt;, service_manager = &lt;service_manager.ServiceManager object at 0x10bcc1a30&gt;

    @pytest.mark.asyncio
    async def test_request_wake_endpoint(self, service_manager):
        """Test wake request API endpoint."""
        from fastapi.testclient import TestClient
        from service_manager import app
    
        # Setup
        app.dependency_overrides[lambda: service_manager] = lambda: service_manager
&gt;       client = TestClient(app)

tests/test_sleep_wake.py:422: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;starlette.testclient.TestClient object at 0x10bcbd910&gt;, app = &lt;fastapi.applications.FastAPI object at 0x10bb43d00&gt;, base_url = 'http://testserver', raise_server_exceptions = True
root_path = '', backend = 'asyncio', backend_options = None, cookies = None, headers = {'user-agent': 'testclient'}

    def __init__(
        self,
        app: ASGIApp,
        base_url: str = "http://testserver",
        raise_server_exceptions: bool = True,
        root_path: str = "",
        backend: str = "asyncio",
        backend_options: typing.Optional[typing.Dict[str, typing.Any]] = None,
        cookies: httpx._client.CookieTypes = None,
        headers: typing.Dict[str, str] = None,
    ) -&gt; None:
        self.async_backend = _AsyncBackend(
            backend=backend, backend_options=backend_options or {}
        )
        if _is_asgi3(app):
            app = typing.cast(ASGI3App, app)
            asgi_app = app
        else:
            app = typing.cast(ASGI2App, app)  # type: ignore[assignment]
            asgi_app = _WrapASGI2(app)  # type: ignore[arg-type]
        self.app = asgi_app
        self.app_state: typing.Dict[str, typing.Any] = {}
        transport = _TestClientTransport(
            self.app,
            portal_factory=self._portal_factory,
            raise_server_exceptions=raise_server_exceptions,
            root_path=root_path,
            app_state=self.app_state,
        )
        if headers is None:
            headers = {}
        headers.setdefault("user-agent", "testclient")
&gt;       super().__init__(
            app=self.app,
            base_url=base_url,
            headers=headers,
            transport=transport,
            follow_redirects=True,
            cookies=cookies,
        )
E       TypeError: __init__() got an unexpected keyword argument 'app'

../../../Library/Python/3.9/lib/python/site-packages/starlette/testclient.py:399: TypeError</failure></testcase><testcase classname="tests.test_sleep_wake.TestAPIEndpoints" name="test_get_service_metrics_endpoint" time="0.002"><failure message="TypeError: __init__() got an unexpected keyword argument 'app'">self = &lt;test_sleep_wake.TestAPIEndpoints object at 0x10b98eee0&gt;, service_manager = &lt;service_manager.ServiceManager object at 0x10beb0970&gt;

    def test_get_service_metrics_endpoint(self, service_manager):
        """Test service metrics API endpoint."""
        from fastapi.testclient import TestClient
        from service_manager import app
    
        # Setup
        app.dependency_overrides[lambda: service_manager] = lambda: service_manager
&gt;       client = TestClient(app)

tests/test_sleep_wake.py:441: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;starlette.testclient.TestClient object at 0x10beb0a90&gt;, app = &lt;fastapi.applications.FastAPI object at 0x10bb43d00&gt;, base_url = 'http://testserver', raise_server_exceptions = True
root_path = '', backend = 'asyncio', backend_options = None, cookies = None, headers = {'user-agent': 'testclient'}

    def __init__(
        self,
        app: ASGIApp,
        base_url: str = "http://testserver",
        raise_server_exceptions: bool = True,
        root_path: str = "",
        backend: str = "asyncio",
        backend_options: typing.Optional[typing.Dict[str, typing.Any]] = None,
        cookies: httpx._client.CookieTypes = None,
        headers: typing.Dict[str, str] = None,
    ) -&gt; None:
        self.async_backend = _AsyncBackend(
            backend=backend, backend_options=backend_options or {}
        )
        if _is_asgi3(app):
            app = typing.cast(ASGI3App, app)
            asgi_app = app
        else:
            app = typing.cast(ASGI2App, app)  # type: ignore[assignment]
            asgi_app = _WrapASGI2(app)  # type: ignore[arg-type]
        self.app = asgi_app
        self.app_state: typing.Dict[str, typing.Any] = {}
        transport = _TestClientTransport(
            self.app,
            portal_factory=self._portal_factory,
            raise_server_exceptions=raise_server_exceptions,
            root_path=root_path,
            app_state=self.app_state,
        )
        if headers is None:
            headers = {}
        headers.setdefault("user-agent", "testclient")
&gt;       super().__init__(
            app=self.app,
            base_url=base_url,
            headers=headers,
            transport=transport,
            follow_redirects=True,
            cookies=cookies,
        )
E       TypeError: __init__() got an unexpected keyword argument 'app'

../../../Library/Python/3.9/lib/python/site-packages/starlette/testclient.py:399: TypeError</failure></testcase><testcase classname="tests.test_sleep_wake.TestMemoryOptimization" name="test_parse_memory_string" time="0.003" /><testcase classname="tests.test_sleep_wake.TestMemoryOptimization" name="test_apply_memory_optimization" time="0.054" /><testcase classname="tests.test_sleep_wake.TestMemoryOptimization" name="test_restore_memory_settings" time="0.074" /></testsuite></testsuites>